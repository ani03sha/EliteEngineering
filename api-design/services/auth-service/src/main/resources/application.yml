spring:
    application:
        name: auth-service

    # Postgres Configuration
    datasource:
        url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:authdb}
        username: ${DB_USERNAME:postgres}
        password: ${DB_PASSWORD:postgres}
        driver-class-name: org.postgresql.Driver
        hikari:
            maximum-pool-size: 10
            minimum-idle: 5
            connection-timeout: 20000
            idle-timeout: 300000
            max-lifetime: 1200000

    # JPA/Hibernate Configuration
    jpa:
        database-platform: org.hibernate.dialect.PostgreSQLDialect
        hibernate:
            ddl-auto: ${DDL_AUTO:validate} # use 'update' for dev, 'validate' for prod
        show-sql: ${SHOW_SQL:false}
        properties:
            hibernate:
                format_sql: true
                use_sql_comments: true
                jdbc:
                    batch_size: 20
                order_inserts: true
                order_updates: true

    # Redis Configuration
    data:
        redis:
            host: ${REDIS_HOST:localhost}
            port: ${REDIS_PORT:6379}
            password: ${REDIS_PASSWORD:}
            database: ${REDIS_DB:0}
            timeout: 200ms
            lettuce:
                pool:
                    max-active: 8
                    max-idle: 8
                    min-idle: 2
                    max-wait: -1ms
                shutdown-timeout: 100ms

# Server Configuration
server:
    port: ${SERVER_PORT:8002}
    servlet:
        context-path: /auth/v1

# JWT Configuration
jwt:
    secret: ${JWT_SECRET:your-256-bit-secret-key-change-this-in-production}
    access-token-expiration: ${JWT_ACCESS_EXPIRATION:900000}    # 15 minutes in ms
    refresh-token-expiration: ${JWT_REFRESH_EXPIRATION:1800000}  # 30 minutes in ms
    issuer: ${JWT_ISSUER:auth-service}

logging:
    level:
        root: info
        com.anirudhology.eliteengineering.auth: ${LOG_LEVEL:info}
        org.springframework.security: ${SECURITY_LOG_LEVEL:info}
        org.hibernate.SQL: ${SQL_LOG_LEVEL:info}
        org.hibernate.type.descriptor.sql.BasicBinder: ${SQL_PARAMETER_LOG_LEVEL:trace}
    pattern:
        console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
        file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Management/Actuator configuration
management:
    endpoints:
        web:
            exposure:
                include:
                    - health
                    - info
                    - metrics
                    - prometheus
    endpoint:
        health:
            show-details: WHEN_AUTHORIZED
    metrics:
        export:
            prometheus:
                enabled: true

# Development Profile
